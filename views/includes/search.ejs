<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Search Example</title>
    <style>
      .search {
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 30px 0 0;
      }

      #searchBox {
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 10px;
        width: 500px;
      }
    </style>
  </head>
  <body>
    <div class="search">
      <form action="/" method="GET">
        <input placeholder="ğŸ”  ìŒì‹, ìŒì‹ ì¹´í…Œê³ ë¦¬ë¥¼ ê²€ìƒ‰í•´ë³´ì„¸ìš”" id="searchBox" type="text" />
        <i class="fa fa-search searchBtn" aria-hidden="true"></i>
      </form>
    </div>
    <div class="result-container">
      <!-- ê²€ìƒ‰ ê²°ê³¼ë¥¼ í‘œì‹œí•  ì˜ì—­ -->
    </div>

    <script>
      const searchBtn = document.querySelector('.searchBtn');
      const searchBox = document.getElementById('searchBox');
      const resultContainer = document.querySelector('.result-container');

      const search = async () => {
        if (!searchBox.value) return alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
        try {
          let foodNameResult = await fetch(`/restaurant?foodName=${searchBox.value}`);
          foodNameResult = await foodNameResult.json();
          // console.log({ foodNameResult });

          let categoryResult = await fetch(`/restaurant?category=${searchBox.value}`);
          categoryResult = await categoryResult.json();
          // console.log({ categoryResult });

          // ê²€ìƒ‰ ê²°ê³¼ë¥¼ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜ í˜¸ì¶œ
          displayResults(foodNameResult, categoryResult);

          console.log(displayResults);
        } catch (error) {
          console.error('ê²€ìƒ‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤:', error.message);
          alert('ê²€ìƒ‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
        }
      };

      const displayResults = (foodNameResult, categoryResult) => {
        // ê²€ìƒ‰ ê²°ê³¼ë¥¼ í™”ë©´ì— í‘œì‹œ
        resultContainer.innerHTML = `
          <h2>ìŒì‹ ì´ë¦„ ê²€ìƒ‰ ê²°ê³¼</h2>
          <ul>
            ${foodNameResult.map((foodname) => `<li>${foodname.data}</li>`).join('')}
          </ul>
          <h2>ì¹´í…Œê³ ë¦¬ ê²€ìƒ‰ ê²°ê³¼</h2>
          <ul>
            ${categoryResult.map((category) => `<li>${category.data}</li>`).join('')}
          </ul>
        `;
      };

      searchBtn.addEventListener('click', search);
      searchBox.addEventListener('keypress', (e) => {
        e.preventDefault();
        if (e.key === 'Enter') search();
      });
      searchBox.focus();
    </script>
  </body>
</html>
